<!doctype html><html lang=zh class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Automatically provision and manage TLS certificates in Kubernetes"><meta name=author content="James Munnelly"><link href=https://cert-manager.io/configuration/acme/dns01/azuredns/ rel=canonical><link rel=icon href=../../../../assets/favicon.png><meta name=generator content="mkdocs-1.4.2, mkdocs-material-8.5.10"><title>AzureDNS - cert-manager</title><link rel=stylesheet href=../../../../assets/stylesheets/main.975780f9.min.css><link rel=stylesheet href=../../../../assets/stylesheets/palette.2505c338.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#azuredns class=md-skip> 跳转至 </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=页眉> <a href=../../../.. title=cert-manager class="md-header__button md-logo" aria-label=cert-manager data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 89 89"> <path d=M3.136,17.387l0,42.932l42.932,21.467l-42.932,-64.399Z /> <path d=M21.91,8l42.933,64.398l-18.775,9.388l-42.932,-64.399l18.774,-9.387Z style="fill-opacity: 0.5"/> <path d=M67.535,17.387l-27.262,18.156l21.878,32.818l5.384,2.691l0,-53.665Z /> <path d=M67.535,17.387l0,53.666l18.774,-9.388l0,-53.665l-18.774,9.387Z style="fill-opacity: 0.25"/> </svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> cert-manager </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> AzureDNS </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg> </label> </form> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=搜索 placeholder=搜索 autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=查找> <a href=javascript:void(0) class="md-search__icon md-icon" title=分享 aria-label=分享 data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=清空当前内容 aria-label=清空当前内容 tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> 正在初始化搜索引擎 </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/cert-manager/cert-manager title=前往仓库 class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> cert-manager/cert-manager </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=标签 data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../../.. class=md-tabs__link> 简介 </a> </li> <li class=md-tabs__item> <a href=../../../../installation/ class=md-tabs__link> 安装 </a> </li> <li class=md-tabs__item> <a href=../../../ class="md-tabs__link md-tabs__link--active"> 配置 </a> </li> <li class=md-tabs__item> <a href=../../../../usage/ class=md-tabs__link> 使用 </a> </li> <li class=md-tabs__item> <a href=../../../../projects/ class=md-tabs__link> 项目 </a> </li> <li class=md-tabs__item> <a href=../../../../tutorials/ class=md-tabs__link> 手册 </a> </li> <li class=md-tabs__item> <a href=../../../../troubleshooting/ class=md-tabs__link> 故障排除 </a> </li> <li class=md-tabs__item> <a href=../../../../concepts/ class=md-tabs__link> 概念 </a> </li> <li class=md-tabs__item> <a href=../../../../reference/ class=md-tabs__link> 参考 </a> </li> <li class=md-tabs__item> <a href=../../../../contributing/ class=md-tabs__link> 贡献 </a> </li> <li class=md-tabs__item> <a href=../../../../release-notes/ class=md-tabs__link> 发布说明 </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=导航栏 data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../../.. title=cert-manager class="md-nav__button md-logo" aria-label=cert-manager data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 89 89"> <path d=M3.136,17.387l0,42.932l42.932,21.467l-42.932,-64.399Z /> <path d=M21.91,8l42.933,64.398l-18.775,9.388l-42.932,-64.399l18.774,-9.387Z style="fill-opacity: 0.5"/> <path d=M67.535,17.387l-27.262,18.156l21.878,32.818l5.384,2.691l0,-53.665Z /> <path d=M67.535,17.387l0,53.666l18.774,-9.388l0,-53.665l-18.774,9.387Z style="fill-opacity: 0.25"/> </svg> </a> cert-manager </label> <div class=md-nav__source> <a href=https://github.com/cert-manager/cert-manager title=前往仓库 class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> cert-manager/cert-manager </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_1 type=checkbox id=__nav_1> <div class="md-nav__link md-nav__link--index "> <a href=../../../..>简介</a> <label for=__nav_1> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label=简介 data-md-level=1> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> 简介 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../getting-started/ class=md-nav__link> 入门 </a> </li> <li class=md-nav__item> <a href=../../../../faq/ class=md-nav__link> FAQ </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2 type=checkbox id=__nav_2> <div class="md-nav__link md-nav__link--index "> <a href=../../../../installation/ >安装</a> <label for=__nav_2> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label=安装 data-md-level=1> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> 安装 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../installation/supported-releases/ class=md-nav__link> 支持版本 </a> </li> <li class=md-nav__item> <a href=../../../../installation/compatibility/ class=md-nav__link> 云兼容性 </a> </li> <li class=md-nav__item> <a href=../../../../installation/kubectl/ class=md-nav__link> kubectl apply </a> </li> <li class=md-nav__item> <a href=../../../../installation/helm/ class=md-nav__link> Helm </a> </li> <li class=md-nav__item> <a href=../../../../installation/operator-lifecycle-manager/ class=md-nav__link> OperatorHub (OLM) </a> </li> <li class=md-nav__item> <a href=../../../../installation/other-tools/ class=md-nav__link> 其他工具 </a> </li> <li class=md-nav__item> <a href=../../../../installation/verify/ class=md-nav__link> 验证 </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_9 type=checkbox id=__nav_2_9> <div class="md-nav__link md-nav__link--index "> <a href=../../../../installation/upgrading/ >更新</a> <label for=__nav_2_9> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label=更新 data-md-level=2> <label class=md-nav__title for=__nav_2_9> <span class="md-nav__icon md-icon"></span> 更新 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../installation/upgrading/ingress-class-compatibility/ class=md-nav__link> 关于入类兼容性的说明 </a> </li> <li class=md-nav__item> <a href=../../../../installation/upgrading/remove-deprecated-apis/ class=md-nav__link> 迁移废弃的API源 </a> </li> <li class=md-nav__item> <a href=../../../../installation/upgrading/upgrading-1.9-1.10/ class=md-nav__link> v1.9 to v1.10 </a> </li> <li class=md-nav__item> <a href=../../../../installation/upgrading/upgrading-1.8-1.9/ class=md-nav__link> v1.8 to v1.9 </a> </li> <li class=md-nav__item> <a href=../../../../installation/upgrading/upgrading-1.7-1.8/ class=md-nav__link> v1.7 to v1.8 </a> </li> <li class=md-nav__item> <a href=../../../../installation/upgrading/upgrading-1.6-1.7/ class=md-nav__link> v1.6 to v1.7 </a> </li> <li class=md-nav__item> <a href=../../../../installation/upgrading/upgrading-1.5-1.6/ class=md-nav__link> v1.5 to v1.6 </a> </li> <li class=md-nav__item> <a href=../../../../installation/upgrading/upgrading-1.4-1.5/ class=md-nav__link> v1.4 to v1.5 </a> </li> <li class=md-nav__item> <a href=../../../../installation/upgrading/upgrading-1.3-1.4/ class=md-nav__link> v1.3 to v1.4 </a> </li> <li class=md-nav__item> <a href=../../../../installation/upgrading/upgrading-1.2-1.3/ class=md-nav__link> v1.2 to v1.3 </a> </li> <li class=md-nav__item> <a href=../../../../installation/upgrading/upgrading-1.1-1.2/ class=md-nav__link> v1.1 to v1.2 </a> </li> <li class=md-nav__item> <a href=../../../../installation/upgrading/upgrading-1.0-1.1/ class=md-nav__link> v1.0 to v1.1 </a> </li> <li class=md-nav__item> <a href=../../../../installation/upgrading/upgrading-0.16-1.0/ class=md-nav__link> v0.16 to v1.0 </a> </li> <li class=md-nav__item> <a href=../../../../installation/upgrading/upgrading-0.15-0.16/ class=md-nav__link> v0.15 to v0.16 </a> </li> <li class=md-nav__item> <a href=../../../../installation/upgrading/upgrading-0.14-0.15/ class=md-nav__link> v0.14 to v0.15 </a> </li> <li class=md-nav__item> <a href=../../../../installation/upgrading/upgrading-0.13-0.14/ class=md-nav__link> v0.13 to v0.14 </a> </li> <li class=md-nav__item> <a href=../../../../installation/upgrading/upgrading-0.12-0.13/ class=md-nav__link> v0.12 to v0.13 </a> </li> <li class=md-nav__item> <a href=../../../../installation/upgrading/upgrading-0.11-0.12/ class=md-nav__link> v0.11 to v0.12 </a> </li> <li class=md-nav__item> <a href=../../../../installation/upgrading/upgrading-0.10-0.11/ class=md-nav__link> v0.10 to v0.11 </a> </li> <li class=md-nav__item> <a href=../../../../installation/upgrading/upgrading-0.9-0.10/ class=md-nav__link> v0.9 to v0.10 </a> </li> <li class=md-nav__item> <a href=../../../../installation/upgrading/upgrading-0.8-0.9/ class=md-nav__link> v0.8 to v0.9 </a> </li> <li class=md-nav__item> <a href=../../../../installation/upgrading/upgrading-0.7-0.8/ class=md-nav__link> v0.7 to v0.8 </a> </li> <li class=md-nav__item> <a href=../../../../installation/upgrading/upgrading-0.6-0.7/ class=md-nav__link> v0.6 to v0.7 </a> </li> <li class=md-nav__item> <a href=../../../../installation/upgrading/upgrading-0.5-0.6/ class=md-nav__link> v0.5 to v0.6 </a> </li> <li class=md-nav__item> <a href=../../../../installation/upgrading/upgrading-0.4-0.5/ class=md-nav__link> v0.4 to v0.5 </a> </li> <li class=md-nav__item> <a href=../../../../installation/upgrading/upgrading-0.3-0.4/ class=md-nav__link> v0.3 to v0.4 </a> </li> <li class=md-nav__item> <a href=../../../../installation/upgrading/upgrading-0.2-0.3/ class=md-nav__link> v0.2 to v0.3 </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../../installation/uninstall/ class=md-nav__link> 卸载 </a> </li> <li class=md-nav__item> <a href=../../../../installation/api-compatibility/ class=md-nav__link> API兼容性 </a> </li> <li class=md-nav__item> <a href=../../../../installation/code-signing/ class=md-nav__link> 签名验证 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 type=checkbox id=__nav_3 checked> <div class="md-nav__link md-nav__link--index "> <a href=../../../ >配置</a> <label for=__nav_3> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label=配置 data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> 配置 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../selfsigned/ class=md-nav__link> SelfSigned </a> </li> <li class=md-nav__item> <a href=../../../ca/ class=md-nav__link> CA </a> </li> <li class=md-nav__item> <a href=../../../vault/ class=md-nav__link> Vault </a> </li> <li class=md-nav__item> <a href=../../../venafi/ class=md-nav__link> Venafi </a> </li> <li class=md-nav__item> <a href=../../../external/ class=md-nav__link> External </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_7 type=checkbox id=__nav_3_7 checked> <div class="md-nav__link md-nav__link--index "> <a href=../../ >ACME</a> <label for=__nav_3_7> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label=ACME data-md-level=2> <label class=md-nav__title for=__nav_3_7> <span class="md-nav__icon md-icon"></span> ACME </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_7_2 type=checkbox id=__nav_3_7_2> <div class="md-nav__link md-nav__link--index "> <a href=../../http01/ >HTTP01</a> <label for=__nav_3_7_2> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label=HTTP01 data-md-level=3> <label class=md-nav__title for=__nav_3_7_2> <span class="md-nav__icon md-icon"></span> HTTP01 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../http01/externalloadbalancer/ class=md-nav__link> 外部负载均衡器 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_7_3 type=checkbox id=__nav_3_7_3 checked> <div class="md-nav__link md-nav__link--index "> <a href=../ >DNS01</a> <label for=__nav_3_7_3> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label=DNS01 data-md-level=3> <label class=md-nav__title for=__nav_3_7_3> <span class="md-nav__icon md-icon"></span> DNS01 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../acme-dns/ class=md-nav__link> ACMEDNS </a> </li> <li class=md-nav__item> <a href=../akamai/ class=md-nav__link> Akamai </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> AzureDNS <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> AzureDNS </a> <nav class="md-nav md-nav--secondary" aria-label=目录> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> 目录 </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#managed-identity-using-aad-pod-identities class=md-nav__link> Managed Identity Using AAD Pod Identities </a> </li> <li class=md-nav__item> <a href=#managed-identity-using-aks-kubelet-identity class=md-nav__link> Managed Identity Using AKS Kubelet Identity </a> </li> <li class=md-nav__item> <a href=#service-principal class=md-nav__link> Service Principal </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../cloudflare/ class=md-nav__link> Cloudflare </a> </li> <li class=md-nav__item> <a href=../digitalocean/ class=md-nav__link> DigitalOcean </a> </li> <li class=md-nav__item> <a href=../google/ class=md-nav__link> Google CloudDNS </a> </li> <li class=md-nav__item> <a href=../rfc2136/ class=md-nav__link> RFC-2136 </a> </li> <li class=md-nav__item> <a href=../route53/ class=md-nav__link> Route53 </a> </li> <li class=md-nav__item> <a href=../webhook/ class=md-nav__link> Webhook </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4 type=checkbox id=__nav_4> <div class="md-nav__link md-nav__link--index "> <a href=../../../../usage/ >使用</a> <label for=__nav_4> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label=使用 data-md-level=1> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> 使用 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../usage/certificate/ class=md-nav__link> 证书源 </a> </li> <li class=md-nav__item> <a href=../../../../usage/prometheus-metrics/ class=md-nav__link> Prometheus Metrics </a> </li> <li class=md-nav__item> <a href=../../../../usage/ingress/ class=md-nav__link> 保护入口源 </a> </li> <li class=md-nav__item> <a href=../../../../usage/gateway/ class=md-nav__link> 保护网关源 </a> </li> <li class=md-nav__item> <a href=../../../../usage/istio/ class=md-nav__link> 保护Istio服务网格 </a> </li> <li class=md-nav__item> <a href=../../../../usage/csi/ class=md-nav__link> CSI驱动 </a> </li> <li class=md-nav__item> <a href=../../../../usage/kube-csr/ class=md-nav__link> Kubernetes CertificateSigningRequests </a> </li> <li class=md-nav__item> <a href=../../../../usage/approver-policy/ class=md-nav__link> cert-manager 证书的策略 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5 type=checkbox id=__nav_5> <div class="md-nav__link md-nav__link--index "> <a href=../../../../projects/ >项目</a> <label for=__nav_5> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label=项目 data-md-level=1> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> 项目 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../projects/istio-csr/ class=md-nav__link> istio-csr </a> </li> <li class=md-nav__item> <a href=../../../../projects/csi-driver/ class=md-nav__link> csi-driver </a> </li> <li class=md-nav__item> <a href=../../../../projects/csi-driver-spiffe/ class=md-nav__link> csi-driver-spiffe </a> </li> <li class=md-nav__item> <a href=../../../../projects/approver-policy/ class=md-nav__link> approver-policy </a> </li> <li class=md-nav__item> <a href=../../../../projects/trust-manager/ class=md-nav__link> trust-manager </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_6 type=checkbox id=__nav_6> <div class="md-nav__link md-nav__link--index "> <a href=../../../../tutorials/ >手册</a> <label for=__nav_6> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label=手册 data-md-level=1> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> 手册 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../tutorials/getting-started-with-cert-manager-on-google-kubernetes-engine-using-lets-encrypt-for-ingress-ssl/ class=md-nav__link> GKE + Ingress + Let's Encrypt </a> </li> <li class=md-nav__item> <a href=../../../../tutorials/acme/migrating-from-kube-lego/ class=md-nav__link> 从Kube-LEGO迁移过来 </a> </li> <li class=md-nav__item> <a href=../../../../tutorials/backup/ class=md-nav__link> 备份与恢复源 </a> </li> <li class=md-nav__item> <a href=../../../../tutorials/acme/dns-validation/ class=md-nav__link> DNS 验证 </a> </li> <li class=md-nav__item> <a href=../../../../tutorials/acme/http-validation/ class=md-nav__link> HTTP 验证 </a> </li> <li class=md-nav__item> <a href=../../../../tutorials/acme/nginx-ingress/ class=md-nav__link> 确保NGINX-ingress </a> </li> <li class=md-nav__item> <a href=../../../../tutorials/acme/pomerium-ingress/ class=md-nav__link> Pomerium Ingress </a> </li> <li class=md-nav__item> <a href=../../../../tutorials/venafi/venafi/ class=md-nav__link> EKS + Ingress + Venafi </a> </li> <li class=md-nav__item> <a href=../../../../tutorials/istio-csr/istio-csr/ class=md-nav__link> 使用cert-manager保护istio Service Mesh </a> </li> <li class=md-nav__item> <a href=../../../../tutorials/syncing-secrets-across-namespaces/ class=md-nav__link> 跨命名空间同步秘密 </a> </li> <li class=md-nav__item> <a href=../../../../tutorials/zerossl/zerossl/ class=md-nav__link> 用ZeroSSL保护入口 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_7 type=checkbox id=__nav_7> <div class="md-nav__link md-nav__link--index "> <a href=../../../../troubleshooting/ >故障排除</a> <label for=__nav_7> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label=故障排除 data-md-level=1> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> 故障排除 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../troubleshooting/acme/ class=md-nav__link> ACME/Let's Encrypt 证书故障处理 </a> </li> <li class=md-nav__item> <a href=../../../../troubleshooting/webhook/ class=md-nav__link> webhook故障处理 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_8 type=checkbox id=__nav_8> <div class="md-nav__link md-nav__link--index "> <a href=../../../../concepts/ >概念</a> <label for=__nav_8> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label=概念 data-md-level=1> <label class=md-nav__title for=__nav_8> <span class="md-nav__icon md-icon"></span> 概念 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../concepts/issuer/ class=md-nav__link> Issuer(颁发者) </a> </li> <li class=md-nav__item> <a href=../../../../concepts/certificate/ class=md-nav__link> Certificate(证书) </a> </li> <li class=md-nav__item> <a href=../../../../concepts/certificaterequest/ class=md-nav__link> CertificateRequest(证书请求) </a> </li> <li class=md-nav__item> <a href=../../../../concepts/acme-orders-challenges/ class=md-nav__link> ACME Orders(命令)和Challenges(挑战) </a> </li> <li class=md-nav__item> <a href=../../../../concepts/webhook/ class=md-nav__link> Webhook(Web钩子) </a> </li> <li class=md-nav__item> <a href=../../../../concepts/ca-injector/ class=md-nav__link> CA Injector(CA 注射器) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_9 type=checkbox id=__nav_9> <div class="md-nav__link md-nav__link--index "> <a href=../../../../reference/ >参考</a> <label for=__nav_9> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label=参考 data-md-level=1> <label class=md-nav__title for=__nav_9> <span class="md-nav__icon md-icon"></span> 参考 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../reference/cmctl/ class=md-nav__link> 命令行工具 (cmctl) </a> </li> <li class=md-nav__item> <a href=../../../../reference/tls-terminology/ class=md-nav__link> TLS 术语 </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_9_4 type=checkbox id=__nav_9_4> <div class="md-nav__link md-nav__link--index "> <a href=../../../../cli/ >组件/ Docker映像</a> <label for=__nav_9_4> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label="组件/ Docker映像" data-md-level=2> <label class=md-nav__title for=__nav_9_4> <span class="md-nav__icon md-icon"></span> 组件/ Docker映像 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../cli/acmesolver/ class=md-nav__link> acmesolver </a> </li> <li class=md-nav__item> <a href=../../../../cli/cainjector/ class=md-nav__link> cainjector </a> </li> <li class=md-nav__item> <a href=../../../../cli/cmctl/ class=md-nav__link> cmctl </a> </li> <li class=md-nav__item> <a href=../../../../cli/controller/ class=md-nav__link> controller </a> </li> <li class=md-nav__item> <a href=../../../../cli/webhook/ class=md-nav__link> webhook </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../../reference/api-docs/ class=md-nav__link> API 参考 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_10 type=checkbox id=__nav_10> <div class="md-nav__link md-nav__link--index "> <a href=../../../../contributing/ >贡献</a> <label for=__nav_10> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label=贡献 data-md-level=1> <label class=md-nav__title for=__nav_10> <span class="md-nav__icon md-icon"></span> 贡献 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../contributing/policy/ class=md-nav__link> 功能政策 </a> </li> <li class=md-nav__item> <a href=../../../../contributing/building/ class=md-nav__link> 构建 cert-manager </a> </li> <li class=md-nav__item> <a href=../../../../contributing/contributing-flow/ class=md-nav__link> 流的贡献 </a> </li> <li class=md-nav__item> <a href=../../../../contributing/crds/ class=md-nav__link> CRDs </a> </li> <li class=md-nav__item> <a href=../../../../contributing/dns-providers/ class=md-nav__link> DNS Providers </a> </li> <li class=md-nav__item> <a href=../../../../contributing/e2e/ class=md-nav__link> 运行端到端测试 </a> </li> <li class=md-nav__item> <a href=../../../../contributing/external-issuers/ class=md-nav__link> 实施外部发行人 </a> </li> <li class=md-nav__item> <a href=../../../../contributing/sign-off/ class=md-nav__link> DCO签署 </a> </li> <li class=md-nav__item> <a href=../../../../contributing/release-process/ class=md-nav__link> 发布过程 </a> </li> <li class=md-nav__item> <a href=../../../../contributing/kind/ class=md-nav__link> 与人为善 </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_10_12 type=checkbox id=__nav_10_12> <div class="md-nav__link md-nav__link--index "> <a href=../../../../contributing/google-season-of-docs/ >谷歌文档季</a> <label for=__nav_10_12> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label=谷歌文档季 data-md-level=2> <label class=md-nav__title for=__nav_10_12> <span class="md-nav__icon md-icon"></span> 谷歌文档季 </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_10_12_2 type=checkbox id=__nav_10_12_2> <div class="md-nav__link md-nav__link--index "> <a href=../../../../contributing/google-season-of-docs/2022/ >2022</a> <label for=__nav_10_12_2> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label=2022 data-md-level=3> <label class=md-nav__title for=__nav_10_12_2> <span class="md-nav__icon md-icon"></span> 2022 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../contributing/google-season-of-docs/2022/improve-navigation-and-structure/ class=md-nav__link> 改进cert-manager网站的导航和结构 </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../../contributing/security/ class=md-nav__link> 报告安全问题 </a> </li> <li class=md-nav__item> <a href=../../../../contributing/coding-conventions/ class=md-nav__link> 代码编写约定 </a> </li> <li class=md-nav__item> <a href=../../../../contributing/third-party-code-donation/ class=md-nav__link> 第三方代码捐赠 </a> </li> <li class=md-nav__item> <a href=../../../../contributing/signing-keys/ class=md-nav__link> 签名密钥 </a> </li> <li class=md-nav__item> <a href=../../../../contributing/importing/ class=md-nav__link> 在Go中导入证书管理器 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_11 type=checkbox id=__nav_11> <div class="md-nav__link md-nav__link--index "> <a href=../../../../release-notes/ >发布说明</a> <label for=__nav_11> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label=发布说明 data-md-level=1> <label class=md-nav__title for=__nav_11> <span class="md-nav__icon md-icon"></span> 发布说明 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../release-notes/release-notes-1.10/ class=md-nav__link> v1.10 </a> </li> <li class=md-nav__item> <a href=../../../../release-notes/release-notes-1.9/ class=md-nav__link> v1.9 </a> </li> <li class=md-nav__item> <a href=../../../../release-notes/release-notes-1.8/ class=md-nav__link> v1.8 </a> </li> <li class=md-nav__item> <a href=../../../../release-notes/release-notes-1.7/ class=md-nav__link> v1.7 </a> </li> <li class=md-nav__item> <a href=../../../../release-notes/release-notes-1.6/ class=md-nav__link> v1.6 </a> </li> <li class=md-nav__item> <a href=../../../../release-notes/release-notes-1.5/ class=md-nav__link> v1.5 </a> </li> <li class=md-nav__item> <a href=../../../../release-notes/release-notes-1.4/ class=md-nav__link> v1.4 </a> </li> <li class=md-nav__item> <a href=../../../../release-notes/release-notes-1.3/ class=md-nav__link> v1.3 </a> </li> <li class=md-nav__item> <a href=../../../../release-notes/release-notes-1.2/ class=md-nav__link> v1.2 </a> </li> <li class=md-nav__item> <a href=../../../../release-notes/release-notes-1.1/ class=md-nav__link> v1.1 </a> </li> <li class=md-nav__item> <a href=../../../../release-notes/release-notes-1.0/ class=md-nav__link> v1.0 </a> </li> <li class=md-nav__item> <a href=../../../../release-notes/release-notes-0.16/ class=md-nav__link> v0.16 </a> </li> <li class=md-nav__item> <a href=../../../../release-notes/release-notes-0.15/ class=md-nav__link> v0.15 </a> </li> <li class=md-nav__item> <a href=../../../../release-notes/release-notes-0.14/ class=md-nav__link> v0.14 </a> </li> <li class=md-nav__item> <a href=../../../../release-notes/release-notes-0.13/ class=md-nav__link> v0.13 </a> </li> <li class=md-nav__item> <a href=../../../../release-notes/release-notes-0.12/ class=md-nav__link> v0.12 </a> </li> <li class=md-nav__item> <a href=../../../../release-notes/release-notes-0.11/ class=md-nav__link> v0.11 </a> </li> <li class=md-nav__item> <a href=../../../../release-notes/release-notes-0.10/ class=md-nav__link> v0.10 </a> </li> <li class=md-nav__item> <a href=../../../../release-notes/release-notes-0.9/ class=md-nav__link> v0.9 </a> </li> <li class=md-nav__item> <a href=../../../../release-notes/release-notes-0.8/ class=md-nav__link> v0.8 </a> </li> <li class=md-nav__item> <a href=../../../../release-notes/release-notes-0.7/ class=md-nav__link> v0.7 </a> </li> <li class=md-nav__item> <a href=../../../../release-notes/release-notes-0.6/ class=md-nav__link> v0.6 </a> </li> <li class=md-nav__item> <a href=../../../../release-notes/release-notes-0.5/ class=md-nav__link> v0.5 </a> </li> <li class=md-nav__item> <a href=../../../../release-notes/release-notes-0.4/ class=md-nav__link> v0.4 </a> </li> <li class=md-nav__item> <a href=../../../../release-notes/release-notes-0.3/ class=md-nav__link> v0.3 </a> </li> <li class=md-nav__item> <a href=../../../../release-notes/release-notes-0.2/ class=md-nav__link> v0.2 </a> </li> <li class=md-nav__item> <a href=../../../../release-notes/release-notes-0.1/ class=md-nav__link> v0.1 </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label=目录> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> 目录 </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#managed-identity-using-aad-pod-identities class=md-nav__link> Managed Identity Using AAD Pod Identities </a> </li> <li class=md-nav__item> <a href=#managed-identity-using-aks-kubelet-identity class=md-nav__link> Managed Identity Using AKS Kubelet Identity </a> </li> <li class=md-nav__item> <a href=#service-principal class=md-nav__link> Service Principal </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/cert-manager/cert-manager/edit/master/docs/configuration/acme/dns01/azuredns.md title=编辑此页 class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg> </a> <h1 id=azuredns>AzureDNS<a class=headerlink href=#azuredns title="Permanent link">&para;</a></h1> <p>'cert-manager configuration: ACME DNS-01 challenges using AzureDNS'</p> <p>To configure the AzureDNS DNS01 Challenge in a Kubernetes cluster there are 3 ways available:</p> <ul> <li><a href=#azuredns>AzureDNS</a></li> <li><a href=#managed-identity-using-aad-pod-identities>Managed Identity Using AAD Pod Identities</a></li> <li><a href=#managed-identity-using-aks-kubelet-identity>Managed Identity Using AKS Kubelet Identity</a></li> <li><a href=#service-principal>Service Principal</a></li> </ul> <h2 id=managed-identity-using-aad-pod-identities>Managed Identity Using AAD Pod Identities<a class=headerlink href=#managed-identity-using-aad-pod-identities title="Permanent link">&para;</a></h2> <p><a href=https://azure.github.io/aad-pod-identity>AAD Pod Identities</a> allows assigning a <a href=https://docs.microsoft.com/en-us/azure/active-directory/managed-identities-azure-resources/overview>Managed Identity</a> to a pod. This removes the need for adding explicit credentials into the cluster to create the required DNS records.</p> <blockquote> <p>Note: When using Pod identity, even though assigning multiple identities to a single pod is allowed, currently cert-manager does not support this as it is not able to identify which identity to use.</p> </blockquote> <p>Firstly an identity should be created that has access to contribute to the DNS Zone.</p> <ul> <li>Example creation using <code>azure-cli</code> and <code>jq</code>:</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=c1># Choose a unique Identity name and existing resource group to create identity in.</span>
<a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=nv>IDENTITY</span><span class=o>=</span><span class=k>$(</span>az identity create --name <span class=nv>$IDENTITY_NAME</span> --resource-group <span class=nv>$IDENTITY_GROUP</span> --output json<span class=k>)</span>
<a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a>
<a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=c1># Gets principalId to use for role assignment</span>
<a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=nv>PRINCIPAL_ID</span><span class=o>=</span><span class=k>$(</span><span class=nb>echo</span> <span class=nv>$IDENTITY</span> <span class=p>|</span> jq -r <span class=s1>&#39;.principalId&#39;</span><span class=k>)</span>
<a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a>
<a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=c1># Used for identity binding</span>
<a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a><span class=nv>CLIENT_ID</span><span class=o>=</span><span class=k>$(</span><span class=nb>echo</span> <span class=nv>$IDENTITY</span> <span class=p>|</span> jq -r <span class=s1>&#39;.clientId&#39;</span><span class=k>)</span>
<a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a><span class=nv>RESOURCE_ID</span><span class=o>=</span><span class=k>$(</span><span class=nb>echo</span> <span class=nv>$IDENTITY</span> <span class=p>|</span> jq -r <span class=s1>&#39;.id&#39;</span><span class=k>)</span>
<a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a>
<a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a><span class=c1># Get existing DNS Zone Id</span>
<a id=__codelineno-0-12 name=__codelineno-0-12 href=#__codelineno-0-12></a><span class=nv>ZONE_ID</span><span class=o>=</span><span class=k>$(</span>az network dns zone show --name <span class=nv>$ZONE_NAME</span> --resource-group <span class=nv>$ZONE_GROUP</span> --query <span class=s2>&quot;id&quot;</span> -o tsv<span class=k>)</span>
<a id=__codelineno-0-13 name=__codelineno-0-13 href=#__codelineno-0-13></a>
<a id=__codelineno-0-14 name=__codelineno-0-14 href=#__codelineno-0-14></a><span class=c1># Create role assignment</span>
<a id=__codelineno-0-15 name=__codelineno-0-15 href=#__codelineno-0-15></a>az role assignment create --role <span class=s2>&quot;DNS Zone Contributor&quot;</span> --assignee <span class=nv>$PRINCIPAL_ID</span> --scope <span class=nv>$ZONE_ID</span>
</code></pre></div> <ul> <li>Example creation using Terraform</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=err>variable</span><span class=w> </span><span class=nb>resource_group_name</span><span class=w> </span><span class=p>{}</span><span class=w></span>
<a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a><span class=err>variable</span><span class=w> </span><span class=nb>location</span><span class=w> </span><span class=p>{}</span><span class=w></span>
<a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a><span class=err>variable</span><span class=w> </span><span class=nb>dns_zone_id</span><span class=w> </span><span class=p>{}</span><span class=c1></span>
<a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a>
<a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a><span class=c1># Creates Identity</span>
<a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a><span class=kr>resource</span><span class=w> </span><span class=nc>&quot;azurerm_user_assigned_identity&quot;</span><span class=w> </span><span class=nv>&quot;dns_identity&quot;</span><span class=w> </span><span class=p>{</span><span class=w></span>
<a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a><span class=w>  </span><span class=na>name</span><span class=w>                </span><span class=o>=</span><span class=w> </span><span class=s2>&quot;cert-manager-dns01&quot;</span><span class=w></span>
<a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a><span class=w>  </span><span class=na>resource_group_name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nv>var.resource_group_name</span><span class=w></span>
<a id=__codelineno-1-9 name=__codelineno-1-9 href=#__codelineno-1-9></a><span class=w>  </span><span class=na>location</span><span class=w>            </span><span class=o>=</span><span class=w> </span><span class=nv>var.location</span><span class=w></span>
<a id=__codelineno-1-10 name=__codelineno-1-10 href=#__codelineno-1-10></a><span class=p>}</span><span class=c1></span>
<a id=__codelineno-1-11 name=__codelineno-1-11 href=#__codelineno-1-11></a>
<a id=__codelineno-1-12 name=__codelineno-1-12 href=#__codelineno-1-12></a><span class=c1># Creates Role Assignment</span>
<a id=__codelineno-1-13 name=__codelineno-1-13 href=#__codelineno-1-13></a><span class=kr>resource</span><span class=w> </span><span class=nc>&quot;azurerm_role_assignment&quot;</span><span class=w> </span><span class=nv>&quot;dns_contributor&quot;</span><span class=w> </span><span class=p>{</span><span class=w></span>
<a id=__codelineno-1-14 name=__codelineno-1-14 href=#__codelineno-1-14></a><span class=w>  </span><span class=na>scope</span><span class=w>                </span><span class=o>=</span><span class=w> </span><span class=nv>var.dns_zone_id</span><span class=w></span>
<a id=__codelineno-1-15 name=__codelineno-1-15 href=#__codelineno-1-15></a><span class=w>  </span><span class=na>role_definition_name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s2>&quot;DNS Zone Contributor&quot;</span><span class=w></span>
<a id=__codelineno-1-16 name=__codelineno-1-16 href=#__codelineno-1-16></a><span class=w>  </span><span class=na>principal_id</span><span class=w>         </span><span class=o>=</span><span class=w> </span><span class=nv>azurerm_user_assigned_identity.dns_identity.principal_id</span><span class=w></span>
<a id=__codelineno-1-17 name=__codelineno-1-17 href=#__codelineno-1-17></a><span class=p>}</span><span class=c1></span>
<a id=__codelineno-1-18 name=__codelineno-1-18 href=#__codelineno-1-18></a>
<a id=__codelineno-1-19 name=__codelineno-1-19 href=#__codelineno-1-19></a><span class=c1># Client Id Used for identity binding</span>
<a id=__codelineno-1-20 name=__codelineno-1-20 href=#__codelineno-1-20></a><span class=kr>output</span><span class=w> </span><span class=nv>&quot;identity_client_id&quot;</span><span class=w> </span><span class=p>{</span><span class=w></span>
<a id=__codelineno-1-21 name=__codelineno-1-21 href=#__codelineno-1-21></a><span class=w>  </span><span class=na>value</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nv>azurerm_user_assigned_identity.dns_identity.client_id</span><span class=w></span>
<a id=__codelineno-1-22 name=__codelineno-1-22 href=#__codelineno-1-22></a><span class=p>}</span><span class=c1></span>
<a id=__codelineno-1-23 name=__codelineno-1-23 href=#__codelineno-1-23></a>
<a id=__codelineno-1-24 name=__codelineno-1-24 href=#__codelineno-1-24></a><span class=c1># Resource Id Used for identity binding</span>
<a id=__codelineno-1-25 name=__codelineno-1-25 href=#__codelineno-1-25></a><span class=kr>output</span><span class=w> </span><span class=nv>&quot;identity_resource_id&quot;</span><span class=w> </span><span class=p>{</span><span class=w></span>
<a id=__codelineno-1-26 name=__codelineno-1-26 href=#__codelineno-1-26></a><span class=w>  </span><span class=na>value</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nv>azurerm_user_assigned_identity.dns_identity.id</span><span class=w></span>
<a id=__codelineno-1-27 name=__codelineno-1-27 href=#__codelineno-1-27></a><span class=p>}</span><span class=w></span>
</code></pre></div> <p>Next we need to ensure we have installed <a href=https://azure.github.io/aad-pod-identity>AAD Pod Identity</a> using their walk-through. This will install the CRDs and deployment required to assign the identity.</p> <p>Now we can create the identity resource and binding using the below manifest as an example:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=s>&quot;aadpodidentity.k8s.io/v1&quot;</span><span class=w></span>
<a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">AzureIdentity</span><span class=w></span>
<a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a><span class=nt>metadata</span><span class=p>:</span><span class=w></span>
<a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a><span class=w>  </span><span class=nt>annotations</span><span class=p>:</span><span class=w></span>
<a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a><span class=w>    </span><span class=c1># recommended to use namespaced identites https://azure.github.io/aad-pod-identity/docs/configure/match_pods_in_namespace/</span><span class=w></span>
<a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a><span class=w>    </span><span class=nt>aadpodidentity.k8s.io/Behavior</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">namespaced</span><span class=w></span>
<a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">certman-identity</span><span class=w></span>
<a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a><span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">cert-manager</span><span class=w> </span><span class=c1># change to your preferred namespace</span><span class=w></span>
<a id=__codelineno-2-9 name=__codelineno-2-9 href=#__codelineno-2-9></a><span class=nt>spec</span><span class=p>:</span><span class=w></span>
<a id=__codelineno-2-10 name=__codelineno-2-10 href=#__codelineno-2-10></a><span class=w>  </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">0</span><span class=w> </span><span class=c1># MSI</span><span class=w></span>
<a id=__codelineno-2-11 name=__codelineno-2-11 href=#__codelineno-2-11></a><span class=w>  </span><span class=nt>resourceID</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">&lt;Identity_Id&gt;</span><span class=w> </span><span class=c1># Resource Id From Previous step</span><span class=w></span>
<a id=__codelineno-2-12 name=__codelineno-2-12 href=#__codelineno-2-12></a><span class=w>  </span><span class=nt>clientID</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">&lt;Client_Id&gt;</span><span class=w> </span><span class=c1># Client Id from previous step</span><span class=w></span>
<a id=__codelineno-2-13 name=__codelineno-2-13 href=#__codelineno-2-13></a><span class=nn>---</span><span class=w></span>
<a id=__codelineno-2-14 name=__codelineno-2-14 href=#__codelineno-2-14></a><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=s>&quot;aadpodidentity.k8s.io/v1&quot;</span><span class=w></span>
<a id=__codelineno-2-15 name=__codelineno-2-15 href=#__codelineno-2-15></a><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">AzureIdentityBinding</span><span class=w></span>
<a id=__codelineno-2-16 name=__codelineno-2-16 href=#__codelineno-2-16></a><span class=nt>metadata</span><span class=p>:</span><span class=w></span>
<a id=__codelineno-2-17 name=__codelineno-2-17 href=#__codelineno-2-17></a><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">certman-id-binding</span><span class=w></span>
<a id=__codelineno-2-18 name=__codelineno-2-18 href=#__codelineno-2-18></a><span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">cert-manager</span><span class=w> </span><span class=c1># change to your preferred namespace</span><span class=w></span>
<a id=__codelineno-2-19 name=__codelineno-2-19 href=#__codelineno-2-19></a><span class=nt>spec</span><span class=p>:</span><span class=w></span>
<a id=__codelineno-2-20 name=__codelineno-2-20 href=#__codelineno-2-20></a><span class=w>  </span><span class=nt>azureIdentity</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">certman-identity</span><span class=w></span>
<a id=__codelineno-2-21 name=__codelineno-2-21 href=#__codelineno-2-21></a><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">certman-label</span><span class=w> </span><span class=c1># This is the label that needs to be set on cert-manager pods</span><span class=w></span>
</code></pre></div> <p>Next we need to ensure the cert-manager pod has a relevant label to use the pod identity binding. This can be done by editing the deployment and adding the below into the <code>.spec.template.metadata.labels</code> field</p> <div class=highlight><pre><span></span><code><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=nt>spec</span><span class=p>:</span><span class=w></span>
<a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a><span class=w>  </span><span class=nt>template</span><span class=p>:</span><span class=w></span>
<a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a><span class=w>    </span><span class=nt>metadata</span><span class=p>:</span><span class=w></span>
<a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a><span class=w>      </span><span class=nt>labels</span><span class=p>:</span><span class=w></span>
<a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a><span class=w>        </span><span class=nt>aadpodidbinding</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">certman-label</span><span class=w> </span><span class=c1># must match selector in AzureIdentityBinding</span><span class=w></span>
</code></pre></div> <p>Or by using the helm values <code>podLabels</code></p> <div class=highlight><pre><span></span><code><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=nt>podLabels</span><span class=p>:</span><span class=w></span>
<a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a><span class=w>  </span><span class=nt>aadpodidbinding</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">certman-label</span><span class=w></span>
</code></pre></div> <p>Lastly when we create the certificate issuer we only need to specify the <code>hostedZoneName</code>, <code>resourceGroupName</code> and <code>subscriptionID</code> fields for the DNS zone. Example below:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">cert-manager.io/v1</span><span class=w></span>
<a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Issuer</span><span class=w></span>
<a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a><span class=nt>metadata</span><span class=p>:</span><span class=w></span>
<a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">example-issuer</span><span class=w></span>
<a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a><span class=nt>spec</span><span class=p>:</span><span class=w></span>
<a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a><span class=w>  </span><span class=nt>acme</span><span class=p>:</span><span class=w></span>
<a id=__codelineno-5-7 name=__codelineno-5-7 href=#__codelineno-5-7></a><span class=w>    </span><span class="l l-Scalar l-Scalar-Plain">...</span><span class=w></span>
<a id=__codelineno-5-8 name=__codelineno-5-8 href=#__codelineno-5-8></a><span class=w>    </span><span class="l l-Scalar l-Scalar-Plain">solvers</span><span class="p p-Indicator">:</span><span class=w></span>
<a id=__codelineno-5-9 name=__codelineno-5-9 href=#__codelineno-5-9></a><span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>dns01</span><span class=p>:</span><span class=w></span>
<a id=__codelineno-5-10 name=__codelineno-5-10 href=#__codelineno-5-10></a><span class=w>        </span><span class=nt>azureDNS</span><span class=p>:</span><span class=w></span>
<a id=__codelineno-5-11 name=__codelineno-5-11 href=#__codelineno-5-11></a><span class=w>          </span><span class=nt>subscriptionID</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">AZURE_SUBSCRIPTION_ID</span><span class=w></span>
<a id=__codelineno-5-12 name=__codelineno-5-12 href=#__codelineno-5-12></a><span class=w>          </span><span class=nt>resourceGroupName</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">AZURE_DNS_ZONE_RESOURCE_GROUP</span><span class=w></span>
<a id=__codelineno-5-13 name=__codelineno-5-13 href=#__codelineno-5-13></a><span class=w>          </span><span class=nt>hostedZoneName</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">AZURE_DNS_ZONE</span><span class=w></span>
<a id=__codelineno-5-14 name=__codelineno-5-14 href=#__codelineno-5-14></a><span class=w>          </span><span class=c1># Azure Cloud Environment, default to AzurePublicCloud</span><span class=w></span>
<a id=__codelineno-5-15 name=__codelineno-5-15 href=#__codelineno-5-15></a><span class=w>          </span><span class=nt>environment</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">AzurePublicCloud</span><span class=w></span>
</code></pre></div> <p>This authentication mechanism is what cert-manager considers 'ambient credentials'. Use of ambient credentials is disabled by default for cert-manager <code>Issuer</code>s. This to ensure unprivileged users who have permission to create issuers cannot issue certificates using any credentials cert-manager incidentally has access to. To enable this authentication mechanism for <code>Issuer</code>s, you will need to set <code>--issuer-ambient-credentials</code> flag on cert-manager controller to true. (There is a corresponding <code>--cluster-issuer-ambient-credentials</code> flag which is set to <code>true</code> by default).</p> <p>If you are using this authentication mechanism and ambient credentials are not enabled, you will see this error:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a>error instantiating azuredns challenge solver: ClientID is not <span class=nb>set</span> but neither --cluster-issuer-ambient-credentials nor --issuer-ambient-credentials are set.
</code></pre></div> <p>These are necessary to enable Azure Managed Identities.</p> <h2 id=managed-identity-using-aks-kubelet-identity>Managed Identity Using AKS Kubelet Identity<a class=headerlink href=#managed-identity-using-aks-kubelet-identity title="Permanent link">&para;</a></h2> <p>When creating an AKS cluster in Azure there is the option to use a managed identity that is assigned to the kubelet. This identity is assigned to the underlying node pool in the AKS cluster and can then be used by the cert-manager pods to authenticate to Azure Active Directory.</p> <p>There are some caveats with this approach, these mainly being:</p> <ul> <li>Any permissions granted to this identity will also be accessible to all containers running inside the Kubernetes cluster.</li> <li>Using AKS extensions like <code>Kube Dashboard</code>, <code>Virtual Node</code>, or <code>HTTP Application Routing</code> (see full list <a href=https://docs.microsoft.com/en-us/azure/aks/use-managed-identity#summary-of-managed-identities>here</a>) will create additional identities that are assigned to your node pools. If your node pools have more than one identity assigned, you will need to specify either <code>clientID</code> or <code>resourceID</code> to select the correct one.</li> </ul> <p>To set this up, firstly you will need to retrieve the identity that the kubelet is using by querying the AKS cluster. This can then be used to create the appropriate permissions in the DNS zone.</p> <ul> <li>Example commands using <code>azure-cli</code>:</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=c1># Get AKS Kubelet Identity</span>
<a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a><span class=nv>PRINCIPAL_ID</span><span class=o>=</span><span class=k>$(</span>az aks show -n <span class=nv>$CLUSTERNAME</span> -g <span class=nv>$CLUSTER_GROUP</span> --query <span class=s2>&quot;identityProfile.kubeletidentity.objectId&quot;</span> -o tsv<span class=k>)</span>
<a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a>
<a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a><span class=c1># Get existing DNS Zone Id</span>
<a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a><span class=nv>ZONE_ID</span><span class=o>=</span><span class=k>$(</span>az network dns zone show --name <span class=nv>$ZONE_NAME</span> --resource-group <span class=nv>$ZONE_GROUP</span> --query <span class=s2>&quot;id&quot;</span> -o tsv<span class=k>)</span>
<a id=__codelineno-7-6 name=__codelineno-7-6 href=#__codelineno-7-6></a>
<a id=__codelineno-7-7 name=__codelineno-7-7 href=#__codelineno-7-7></a><span class=c1># Create role assignment</span>
<a id=__codelineno-7-8 name=__codelineno-7-8 href=#__codelineno-7-8></a>az role assignment create --role <span class=s2>&quot;DNS Zone Contributor&quot;</span> --assignee <span class=nv>$PRINCIPAL_ID</span> --scope <span class=nv>$ZONE_ID</span>
</code></pre></div> <ul> <li>Example terraform:</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=err>variable</span><span class=w> </span><span class=nb>dns_zone_id</span><span class=w> </span><span class=p>{}</span><span class=c1></span>
<a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a>
<a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a><span class=c1># Creating the AKS cluster, abbreviated.</span>
<a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a><span class=kr>resource</span><span class=w> </span><span class=nc>&quot;azurerm_kubernetes_cluster&quot;</span><span class=w> </span><span class=nv>&quot;cluster&quot;</span><span class=w> </span><span class=p>{</span><span class=w></span>
<a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a><span class=w>  </span><span class=p>...</span><span class=c1></span>
<a id=__codelineno-8-6 name=__codelineno-8-6 href=#__codelineno-8-6></a><span class=c1>  # Creates Identity associated to kubelet</span>
<a id=__codelineno-8-7 name=__codelineno-8-7 href=#__codelineno-8-7></a><span class=w>  </span><span class=nb>identity</span><span class=w> </span><span class=p>{</span><span class=w></span>
<a id=__codelineno-8-8 name=__codelineno-8-8 href=#__codelineno-8-8></a><span class=w>    </span><span class=na>type</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s2>&quot;SystemAssigned&quot;</span><span class=w></span>
<a id=__codelineno-8-9 name=__codelineno-8-9 href=#__codelineno-8-9></a><span class=w>  </span><span class=p>}</span><span class=w></span>
<a id=__codelineno-8-10 name=__codelineno-8-10 href=#__codelineno-8-10></a><span class=w>  </span><span class=p>...</span><span class=w></span>
<a id=__codelineno-8-11 name=__codelineno-8-11 href=#__codelineno-8-11></a><span class=p>}</span><span class=w></span>
<a id=__codelineno-8-12 name=__codelineno-8-12 href=#__codelineno-8-12></a>
<a id=__codelineno-8-13 name=__codelineno-8-13 href=#__codelineno-8-13></a><span class=kr>resource</span><span class=w> </span><span class=nc>&quot;azurerm_role_assignment&quot;</span><span class=w> </span><span class=nv>&quot;dns_contributor&quot;</span><span class=w> </span><span class=p>{</span><span class=w></span>
<a id=__codelineno-8-14 name=__codelineno-8-14 href=#__codelineno-8-14></a><span class=w>  </span><span class=na>scope</span><span class=w>                            </span><span class=o>=</span><span class=w> </span><span class=nv>var.dns_zone_id</span><span class=w></span>
<a id=__codelineno-8-15 name=__codelineno-8-15 href=#__codelineno-8-15></a><span class=w>  </span><span class=na>role_definition_name</span><span class=w>             </span><span class=o>=</span><span class=w> </span><span class=s2>&quot;DNS Zone Contributor&quot;</span><span class=w></span>
<a id=__codelineno-8-16 name=__codelineno-8-16 href=#__codelineno-8-16></a><span class=w>  </span><span class=na>principal_id</span><span class=w>                     </span><span class=o>=</span><span class=w> </span><span class=nv>azurerm_kubernetes_cluster.cluster.kubelet_identity[0].object_id</span><span class=w></span>
<a id=__codelineno-8-17 name=__codelineno-8-17 href=#__codelineno-8-17></a><span class=w>  </span><span class=na>skip_service_principal_aad_check</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=no>true</span><span class=c1> # Allows skipping propagation of identity to ensure assignment succeeds.</span>
<a id=__codelineno-8-18 name=__codelineno-8-18 href=#__codelineno-8-18></a><span class=p>}</span><span class=w></span>
</code></pre></div> <p>Then when creating the cert-manager issuer we need to specify the <code>hostedZoneName</code>, <code>resourceGroupName</code> and <code>subscriptionID</code> fields for the DNS Zone.</p> <p>We also need to specify <code>managedIdentity.clientID</code> or <code>managedIdentity.resourceID</code> if multiple managed identities are assigned to the node pools.</p> <p>The value for <code>managedIdentity.clientID</code> can be fetched by running this command:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a>az aks show -n <span class=nv>$CLUSTERNAME</span> -g <span class=nv>$CLUSTER_GROUP</span> --query <span class=s2>&quot;identityProfile.kubeletidentity.clientId&quot;</span> -o tsv
</code></pre></div> <p>Example below:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">cert-manager.io/v1</span><span class=w></span>
<a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Issuer</span><span class=w></span>
<a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a><span class=nt>metadata</span><span class=p>:</span><span class=w></span>
<a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">example-issuer</span><span class=w></span>
<a id=__codelineno-10-5 name=__codelineno-10-5 href=#__codelineno-10-5></a><span class=nt>spec</span><span class=p>:</span><span class=w></span>
<a id=__codelineno-10-6 name=__codelineno-10-6 href=#__codelineno-10-6></a><span class=w>  </span><span class=nt>acme</span><span class=p>:</span><span class=w></span>
<a id=__codelineno-10-7 name=__codelineno-10-7 href=#__codelineno-10-7></a><span class=w>    </span><span class="l l-Scalar l-Scalar-Plain">...</span><span class=w></span>
<a id=__codelineno-10-8 name=__codelineno-10-8 href=#__codelineno-10-8></a><span class=w>    </span><span class="l l-Scalar l-Scalar-Plain">solvers</span><span class="p p-Indicator">:</span><span class=w></span>
<a id=__codelineno-10-9 name=__codelineno-10-9 href=#__codelineno-10-9></a><span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>dns01</span><span class=p>:</span><span class=w></span>
<a id=__codelineno-10-10 name=__codelineno-10-10 href=#__codelineno-10-10></a><span class=w>        </span><span class=nt>azureDNS</span><span class=p>:</span><span class=w></span>
<a id=__codelineno-10-11 name=__codelineno-10-11 href=#__codelineno-10-11></a><span class=w>          </span><span class=nt>subscriptionID</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">AZURE_SUBSCRIPTION_ID</span><span class=w></span>
<a id=__codelineno-10-12 name=__codelineno-10-12 href=#__codelineno-10-12></a><span class=w>          </span><span class=nt>resourceGroupName</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">AZURE_DNS_ZONE_RESOURCE_GROUP</span><span class=w></span>
<a id=__codelineno-10-13 name=__codelineno-10-13 href=#__codelineno-10-13></a><span class=w>          </span><span class=nt>hostedZoneName</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">AZURE_DNS_ZONE</span><span class=w></span>
<a id=__codelineno-10-14 name=__codelineno-10-14 href=#__codelineno-10-14></a><span class=w>          </span><span class=c1># Azure Cloud Environment, default to AzurePublicCloud</span><span class=w></span>
<a id=__codelineno-10-15 name=__codelineno-10-15 href=#__codelineno-10-15></a><span class=w>          </span><span class=nt>environment</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">AzurePublicCloud</span><span class=w></span>
<a id=__codelineno-10-16 name=__codelineno-10-16 href=#__codelineno-10-16></a><span class=w>          </span><span class=c1># optional, only required if node pools have more than 1 managed identity assigned</span><span class=w></span>
<a id=__codelineno-10-17 name=__codelineno-10-17 href=#__codelineno-10-17></a><span class=w>          </span><span class=nt>managedIdentity</span><span class=p>:</span><span class=w></span>
<a id=__codelineno-10-18 name=__codelineno-10-18 href=#__codelineno-10-18></a><span class=w>            </span><span class=c1># client id of the node pool managed identity (can not be set at the same time as resourceID)</span><span class=w></span>
<a id=__codelineno-10-19 name=__codelineno-10-19 href=#__codelineno-10-19></a><span class=w>            </span><span class=nt>clientID</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">YOUR_MANAGED_IDENTITY_CLIENT_ID</span><span class=w></span>
<a id=__codelineno-10-20 name=__codelineno-10-20 href=#__codelineno-10-20></a><span class=w>            </span><span class=c1># resource id of the managed identity (can not be set at the same time as clientID)</span><span class=w></span>
<a id=__codelineno-10-21 name=__codelineno-10-21 href=#__codelineno-10-21></a><span class=w>            </span><span class=c1># resourceID: YOUR_MANAGED_IDENTITY_RESOURCE_ID</span><span class=w></span>
</code></pre></div> <h2 id=service-principal>Service Principal<a class=headerlink href=#service-principal title="Permanent link">&para;</a></h2> <p>Configuring the AzureDNS DNS01 Challenge for a Kubernetes cluster requires creating a service principal in Azure.</p> <p>To create the service principal you can use the following script (requires <code>azure-cli</code> and <code>jq</code>):</p> <div class=highlight><pre><span></span><code><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a><span class=c1># Choose a name for the service principal that contacts azure DNS to present</span>
<a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a><span class=c1># the challenge.</span>
<a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a>$ <span class=nv>AZURE_CERT_MANAGER_NEW_SP_NAME</span><span class=o>=</span>NEW_SERVICE_PRINCIPAL_NAME
<a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a><span class=c1># This is the name of the resource group that you have your dns zone in.</span>
<a id=__codelineno-11-5 name=__codelineno-11-5 href=#__codelineno-11-5></a>$ <span class=nv>AZURE_DNS_ZONE_RESOURCE_GROUP</span><span class=o>=</span>AZURE_DNS_ZONE_RESOURCE_GROUP
<a id=__codelineno-11-6 name=__codelineno-11-6 href=#__codelineno-11-6></a><span class=c1># The DNS zone name. It should be something like domain.com or sub.domain.com.</span>
<a id=__codelineno-11-7 name=__codelineno-11-7 href=#__codelineno-11-7></a>$ <span class=nv>AZURE_DNS_ZONE</span><span class=o>=</span>AZURE_DNS_ZONE
<a id=__codelineno-11-8 name=__codelineno-11-8 href=#__codelineno-11-8></a>
<a id=__codelineno-11-9 name=__codelineno-11-9 href=#__codelineno-11-9></a>$ <span class=nv>DNS_SP</span><span class=o>=</span><span class=k>$(</span>az ad sp create-for-rbac --name <span class=nv>$AZURE_CERT_MANAGER_NEW_SP_NAME</span> --output json<span class=k>)</span>
<a id=__codelineno-11-10 name=__codelineno-11-10 href=#__codelineno-11-10></a>$ <span class=nv>AZURE_CERT_MANAGER_SP_APP_ID</span><span class=o>=</span><span class=k>$(</span><span class=nb>echo</span> <span class=nv>$DNS_SP</span> <span class=p>|</span> jq -r <span class=s1>&#39;.appId&#39;</span><span class=k>)</span>
<a id=__codelineno-11-11 name=__codelineno-11-11 href=#__codelineno-11-11></a>$ <span class=nv>AZURE_CERT_MANAGER_SP_PASSWORD</span><span class=o>=</span><span class=k>$(</span><span class=nb>echo</span> <span class=nv>$DNS_SP</span> <span class=p>|</span> jq -r <span class=s1>&#39;.password&#39;</span><span class=k>)</span>
<a id=__codelineno-11-12 name=__codelineno-11-12 href=#__codelineno-11-12></a>$ <span class=nv>AZURE_TENANT_ID</span><span class=o>=</span><span class=k>$(</span><span class=nb>echo</span> <span class=nv>$DNS_SP</span> <span class=p>|</span> jq -r <span class=s1>&#39;.tenant&#39;</span><span class=k>)</span>
<a id=__codelineno-11-13 name=__codelineno-11-13 href=#__codelineno-11-13></a>$ <span class=nv>AZURE_SUBSCRIPTION_ID</span><span class=o>=</span><span class=k>$(</span>az account show --output json <span class=p>|</span> jq -r <span class=s1>&#39;.id&#39;</span><span class=k>)</span>
</code></pre></div> <p>For security purposes, it is appropriate to utilize RBAC to ensure that you properly maintain access control to your resources in Azure. The service principal that is generated by this tutorial has fine-grained access to ONLY the DNS Zone in the specific resource group specified. It requires this permission so that it can read/write the _acme_challenge TXT records to the zone.</p> <p>Lower the Permissions of the service principal.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a>$ az role assignment delete --assignee <span class=nv>$AZURE_CERT_MANAGER_SP_APP_ID</span> --role Contributor
</code></pre></div> <p>Give Access to DNS Zone.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a>$ <span class=nv>DNS_ID</span><span class=o>=</span><span class=k>$(</span>az network dns zone show --name <span class=nv>$AZURE_DNS_ZONE</span> --resource-group <span class=nv>$AZURE_DNS_ZONE_RESOURCE_GROUP</span> --query <span class=s2>&quot;id&quot;</span> --output tsv<span class=k>)</span>
<a id=__codelineno-13-2 name=__codelineno-13-2 href=#__codelineno-13-2></a>$ az role assignment create --assignee <span class=nv>$AZURE_CERT_MANAGER_SP_APP_ID</span> --role <span class=s2>&quot;DNS Zone Contributor&quot;</span> --scope <span class=nv>$DNS_ID</span>
</code></pre></div> <p>Check Permissions. As the result of the following command, we would like to see just one object in the permissions array with "DNS Zone Contributor" role.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a>$ az role assignment list --all --assignee <span class=nv>$AZURE_CERT_MANAGER_SP_APP_ID</span>
</code></pre></div> <p>A secret containing service principal password should be created on Kubernetes to facilitate presenting the challenge to Azure DNS. You can create the secret with the following command:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a>$ kubectl create secret generic azuredns-config --from-literal<span class=o>=</span>client-secret<span class=o>=</span><span class=nv>$AZURE_CERT_MANAGER_SP_PASSWORD</span>
</code></pre></div> <p>Get the variables for configuring the issuer.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a>$ <span class=nb>echo</span> <span class=s2>&quot;AZURE_CERT_MANAGER_SP_APP_ID: </span><span class=nv>$AZURE_CERT_MANAGER_SP_APP_ID</span><span class=s2>&quot;</span>
<a id=__codelineno-16-2 name=__codelineno-16-2 href=#__codelineno-16-2></a>$ <span class=nb>echo</span> <span class=s2>&quot;AZURE_CERT_MANAGER_SP_PASSWORD: </span><span class=nv>$AZURE_CERT_MANAGER_SP_PASSWORD</span><span class=s2>&quot;</span>
<a id=__codelineno-16-3 name=__codelineno-16-3 href=#__codelineno-16-3></a>$ <span class=nb>echo</span> <span class=s2>&quot;AZURE_SUBSCRIPTION_ID: </span><span class=nv>$AZURE_SUBSCRIPTION_ID</span><span class=s2>&quot;</span>
<a id=__codelineno-16-4 name=__codelineno-16-4 href=#__codelineno-16-4></a>$ <span class=nb>echo</span> <span class=s2>&quot;AZURE_TENANT_ID: </span><span class=nv>$AZURE_TENANT_ID</span><span class=s2>&quot;</span>
<a id=__codelineno-16-5 name=__codelineno-16-5 href=#__codelineno-16-5></a>$ <span class=nb>echo</span> <span class=s2>&quot;AZURE_DNS_ZONE: </span><span class=nv>$AZURE_DNS_ZONE</span><span class=s2>&quot;</span>
<a id=__codelineno-16-6 name=__codelineno-16-6 href=#__codelineno-16-6></a>$ <span class=nb>echo</span> <span class=s2>&quot;AZURE_DNS_ZONE_RESOURCE_GROUP: </span><span class=nv>$AZURE_DNS_ZONE_RESOURCE_GROUP</span><span class=s2>&quot;</span>
</code></pre></div> <p>To configure the issuer, substitute the capital cased variables with the values from the previous script. You can get the subscription id from the Azure portal.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-17-1 name=__codelineno-17-1 href=#__codelineno-17-1></a><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">cert-manager.io/v1</span><span class=w></span>
<a id=__codelineno-17-2 name=__codelineno-17-2 href=#__codelineno-17-2></a><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Issuer</span><span class=w></span>
<a id=__codelineno-17-3 name=__codelineno-17-3 href=#__codelineno-17-3></a><span class=nt>metadata</span><span class=p>:</span><span class=w></span>
<a id=__codelineno-17-4 name=__codelineno-17-4 href=#__codelineno-17-4></a><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">example-issuer</span><span class=w></span>
<a id=__codelineno-17-5 name=__codelineno-17-5 href=#__codelineno-17-5></a><span class=nt>spec</span><span class=p>:</span><span class=w></span>
<a id=__codelineno-17-6 name=__codelineno-17-6 href=#__codelineno-17-6></a><span class=w>  </span><span class=nt>acme</span><span class=p>:</span><span class=w></span>
<a id=__codelineno-17-7 name=__codelineno-17-7 href=#__codelineno-17-7></a><span class=w>    </span><span class="l l-Scalar l-Scalar-Plain">...</span><span class=w></span>
<a id=__codelineno-17-8 name=__codelineno-17-8 href=#__codelineno-17-8></a><span class=w>    </span><span class="l l-Scalar l-Scalar-Plain">solvers</span><span class="p p-Indicator">:</span><span class=w></span>
<a id=__codelineno-17-9 name=__codelineno-17-9 href=#__codelineno-17-9></a><span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>dns01</span><span class=p>:</span><span class=w></span>
<a id=__codelineno-17-10 name=__codelineno-17-10 href=#__codelineno-17-10></a><span class=w>        </span><span class=nt>azureDNS</span><span class=p>:</span><span class=w></span>
<a id=__codelineno-17-11 name=__codelineno-17-11 href=#__codelineno-17-11></a><span class=w>          </span><span class=nt>clientID</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">AZURE_CERT_MANAGER_SP_APP_ID</span><span class=w></span>
<a id=__codelineno-17-12 name=__codelineno-17-12 href=#__codelineno-17-12></a><span class=w>          </span><span class=nt>clientSecretSecretRef</span><span class=p>:</span><span class=w></span>
<a id=__codelineno-17-13 name=__codelineno-17-13 href=#__codelineno-17-13></a><span class=w>          </span><span class=c1># The following is the secret we created in Kubernetes. Issuer will use this to present challenge to Azure DNS.</span><span class=w></span>
<a id=__codelineno-17-14 name=__codelineno-17-14 href=#__codelineno-17-14></a><span class=w>            </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">azuredns-config</span><span class=w></span>
<a id=__codelineno-17-15 name=__codelineno-17-15 href=#__codelineno-17-15></a><span class=w>            </span><span class=nt>key</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">client-secret</span><span class=w></span>
<a id=__codelineno-17-16 name=__codelineno-17-16 href=#__codelineno-17-16></a><span class=w>          </span><span class=nt>subscriptionID</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">AZURE_SUBSCRIPTION_ID</span><span class=w></span>
<a id=__codelineno-17-17 name=__codelineno-17-17 href=#__codelineno-17-17></a><span class=w>          </span><span class=nt>tenantID</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">AZURE_TENANT_ID</span><span class=w></span>
<a id=__codelineno-17-18 name=__codelineno-17-18 href=#__codelineno-17-18></a><span class=w>          </span><span class=nt>resourceGroupName</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">AZURE_DNS_ZONE_RESOURCE_GROUP</span><span class=w></span>
<a id=__codelineno-17-19 name=__codelineno-17-19 href=#__codelineno-17-19></a><span class=w>          </span><span class=nt>hostedZoneName</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">AZURE_DNS_ZONE</span><span class=w></span>
<a id=__codelineno-17-20 name=__codelineno-17-20 href=#__codelineno-17-20></a><span class=w>          </span><span class=c1># Azure Cloud Environment, default to AzurePublicCloud</span><span class=w></span>
<a id=__codelineno-17-21 name=__codelineno-17-21 href=#__codelineno-17-21></a><span class=w>          </span><span class=nt>environment</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">AzurePublicCloud</span><span class=w></span>
</code></pre></div> </article> </div> </div> <a href=# class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> 回到页面顶部 </a> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=页脚> <a href=../akamai/ class="md-footer__link md-footer__link--prev" aria-label="上一页: Akamai" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> 上一页 </span> Akamai </div> </div> </a> <a href=../cloudflare/ class="md-footer__link md-footer__link--next" aria-label="下一页: Cloudflare" rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> 下一页 </span> Cloudflare </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> © 2022 The cert-manager Authors. © 2022 The Linux Foundation. All rights reserved. </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/cert-manager/cert-manager target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a> <a href=https://infosec.exchange/@CertManager target=_blank rel=noopener title=infosec.exchange class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M433 179.11c0-97.2-63.71-125.7-63.71-125.7-62.52-28.7-228.56-28.4-290.48 0 0 0-63.72 28.5-63.72 125.7 0 115.7-6.6 259.4 105.63 289.1 40.51 10.7 75.32 13 103.33 11.4 50.81-2.8 79.32-18.1 79.32-18.1l-1.7-36.9s-36.31 11.4-77.12 10.1c-40.41-1.4-83-4.4-89.63-54a102.54 102.54 0 0 1-.9-13.9c85.63 20.9 158.65 9.1 178.75 6.7 56.12-6.7 105-41.3 111.23-72.9 9.8-49.8 9-121.5 9-121.5zm-75.12 125.2h-46.63v-114.2c0-49.7-64-51.6-64 6.9v62.5h-46.33V197c0-58.5-64-56.6-64-6.9v114.2H90.19c0-122.1-5.2-147.9 18.41-175 25.9-28.9 79.82-30.8 103.83 6.1l11.6 19.5 11.6-19.5c24.11-37.1 78.12-34.8 103.83-6.1 23.71 27.3 18.4 53 18.4 175z"/></svg> </a> <a href=https://twitter.com/CertManager/ target=_blank rel=noopener title=twitter.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../../..", "features": ["content.code.annotate", "content.tooltips", "navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../../../assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.config.lang": "ja", "search.config.pipeline": "trimmer, stemmer", "search.config.separator": "[\\s\\-\uff0c\u3002]+", "search.placeholder": "\u641c\u7d22", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version.title": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script> <script src=../../../../assets/javascripts/bundle.5a2dcb6a.min.js></script> </body> </html>